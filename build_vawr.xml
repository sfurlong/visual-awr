<?xml version="1.0" encoding="windows-1252" ?>
<!--Ant buildfile generated by Oracle JDeveloper-->
<!--Generated May 9, 2014 4:39:29 PM-->
<project name="AWRParser" default="all">
  <property file="build.properties"/>
  <property name="build.root.dir" value="."/>
  <path id="library.Jcommon-1.0.22.jar">
    <pathelement location="lib/jcommon-1.0.22/jcommon-1.0.22/jcommon-1.0.22.jar"/>
  </path>
  <path id="library.Jfreechart-1.0.17.jar">
    <pathelement location="lib/jfreechart-1.0.17/jfreechart-1.0.17/lib/jfreechart-1.0.17.jar"/>
  </path>
  <path id="library.Jcommon-xml-1.0.22.jar">
    <pathelement location="lib/jcommon-1.0.22/jcommon-1.0.22/jcommon-xml-1.0.22.jar"/>
  </path>
  <path id="library.Ojdbc5.jar">
    <pathelement location="lib/ojdbc5.jar"/>
  </path>
  <path id="library.commons-compress-1.8.1.jar">
    <pathelement location="lib/commons-compress-1.8.1.jar"/>
  </path>
  <path id="library.junit-4.12.jar">
    <pathelement location="lib/junit-4.12.jar"/>
  </path>
  <path id="classpath">
    <path refid="library.Jcommon-1.0.22.jar"/>
    <path refid="library.Jfreechart-1.0.17.jar"/>
    <path refid="library.Jcommon-xml-1.0.22.jar"/>
    <path refid="library.Ojdbc5.jar"/>
    <path refid="library.commons-compress-1.8.1.jar"/>
    <path refid="library.junit-4.12.jar"/>
  </path>
  
  <!-- TARGET ALL -->
  <target name="all">
  	<antcall target="clean"></antcall>
  	<antcall target="build"></antcall>
  	<antcall target="jar"></antcall>
  	<antcall target="dist"></antcall>
  </target>
  
  <!-- TARGET CLEAN -->
  <target name="clean" description="Clean the project">
    <delete includeemptydirs="true" quiet="true">
      <fileset dir="${build.root.dir}/classes" includes="**/*"/>
    </delete>
  </target>
  
  <target name="version" description="Replaces the version# in code and readme">
    <replace file="${build.root.dir}/src/org/altaprise/vawr/ui/RootFrame.java" token="${visual-awr.version.old}" value="${visual-awr.version.num}"/>
    <replace file="${build.root.dir}/vawr-readme.html" token="${visual-awr.version.old}" value="${visual-awr.version.num}"/>
  </target>
  
  <target name="build" description="Compile Java source files" depends="version">
    <mkdir dir="${build.root.dir}/classes"/>
    <javac srcdir="${build.root.dir}/src" destdir="${build.root.dir}/classes"
           classpath="${classpath}" includes="*/**/*.java" deprecation="on"
           failonerror="true" debug="${debug}"/>
  </target>
  
  <target name="jar" description="Build the Jar file(s)">
   <delete file="${build.root.dir}/lib/vawr.jar"/>
   <delete file="${build.root.dir}/lib/vawr-utils.jar"/>
    <jar jarfile="${build.root.dir}/lib/vawr.jar"
         basedir="${build.root.dir}/classes" 
         excludes="/org/altaprise/vawr/utils/**/*" 
    />
    <jar jarfile="${build.root.dir}/lib/vawr-utils.jar"
         basedir="${build.root.dir}/classes"
         includes="/org/altaprise/vawr/utils/**/*"
    />
  </target>
  

  <target name="junit" description="JUnit Testing" depends="version">
    <junit>
        <classpath refid="classpath" />
      <test name="org.altaprise.test.TestDemoFilesAndCharts" todir="${build.root.dir}" haltonfailure="no" outfile="result"/>
    </junit>
  </target>

  <target name="dist" description="create the distribution" depends="jar">
    <delete includeemptydirs="true" dir="${build.root.dir}/dist"/>
    <mkdir dir="${build.root.dir}/dist"/>
    <mkdir dir="${build.root.dir}/dist/lib"/>
    
    <copy todir="${build.root.dir}/dist/lib">
      <fileset dir="${build.root.dir}/lib">
        <include name="jfreechart*.jar"/>
        <include name="jfreesvg*.jar"/>
        <include name="jcommon*.jar"/>
        <include name="commons-compress*.jar"/>
        <include name="ojdbc*.jar"/>
        <include name="vawr.jar"/>
        <include name="vawr-utils.jar"/>
        <include name="*.gif"/>
      </fileset>
      <fileset dir="${build.root.dir}/docs">
        <include name="awr_miner.sql"/>
      </fileset>
    </copy>

    <copy todir="${build.root.dir}/dist">
      <fileset dir="${build.root.dir}">
        <include name="vawr-readme.html"/>
        <include name="run.bat"/>
        <include name="run.sh"/>
        <include name="properties.ser"/>
      </fileset>
    </copy>
    
    <!--Copy Test Files -->
    <copy todir="${build.root.dir}/dist/testing">
      <fileset dir="${build.root.dir}/testing">
        <include name="**/AWRMiner/**/*EDWPRD*.out"/>
        <include name="**/AWRMiner/**/*XXXX*.out"/>
        <include name="**/AWRMiner/**/*awr-hist-3486853636*.out"/>
      </fileset>
      <fileset dir="${build.root.dir}/testing">
        <include name="**/IOStat-Linux/**/*.dat"/>
      </fileset>
      <fileset dir="${build.root.dir}/testing">
        <include name="**/TopStat-Linux/**/*.dat"/>
      </fileset>
      <fileset dir="${build.root.dir}/testing">
        <include name="**/TopStat-SunOS/**/*.dat"/>
      </fileset>
      <fileset dir="${build.root.dir}/testing">
        <include name="**/CellSrvStat/**/*.dat"/>
      </fileset>
    </copy>

    <zip destfile="./dist/visual-awr-${visual-awr.version.num}.zip"
         basedir="./dist/" excludes="jdk/**, *.zip"/>

  </target>

</project>
